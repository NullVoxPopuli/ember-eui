{{#let
  (arg-or-default @buttonSize "s")
  (arg-or-default @color "text")
  (arg-or-default @isFullWidth false)
  (arg-or-default @isDisabled false)
  (arg-or-default @type "single")
  as |buttonSize color isFullWidth isDisabled type|
}}
  {{#let
    (if (and (eq buttonSize "compressed") (eq color "ghost")) "text" color)
    (eq type "single")
    as |resolvedColor typeIsSingle|
  }}

    <fieldset
      class={{class-names
        "euiButtonGroup"
        (if isFullWidth "euiButtonGroup--fullWidth")
        (if isDisabled "euiButtonGroup--fullWidth")
        @className
        componentName="EuiButtonGroup"
        size=(arg-or-default buttonSize "s")
        color=resolvedColor
      }}
      disabled={{isDisabled}}
      ...attributes
    >
      <legend {{screen-reader-only}}>{{@legend}}</legend>
      <div class="euiButtonGroup__buttons">
        {{#let (arg-or-default @name (unique-id)) as |name|}}
          {{#each @options as |option|}}
            <EuiButtonGroupButton
              @name={{name}}
              @isDisabled={{if
                (not-eq option.isDisabled undefined)
                option.isDisabled
                isDisabled
              }}
              @element={{if typeIsSingle "label" "button"}}
              @isSelected={{if
                typeIsSingle
                (eq option.id @idSelected)
                (get @idToSelectedMap option.id)
              }}
              @color={{resolvedColor}}
              @size={{buttonSize}}
              @isIconOnly={{@isIconOnly}}
              @onChange={{@onChange}}
              @iconType={{option.iconType}}
              @value={{option.value}}
              @label={{option.label}}
              @id={{option.id}}
              @isLoading={{option.isLoading}}
              @iconSide={{option.iconSide}}
              @iconSize={{option.iconSize}}
              @textClasses={{option.textClasses}}
              @contentClasses={{option.contentClasses}}
              @iconClasses={{option.iconClasses}}
              @type={{option.type}}
              class={{option.className}}
              aria-label={{option.aria-label}}
            />
          {{/each}}
        {{/let}}
      </div>
    </fieldset>
  {{/let}}
{{/let}}