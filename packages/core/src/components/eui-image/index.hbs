{{#if @allowFullScreen}}
  <figure
    class={{class-names
      "euiImage--allowFullScreen"
      (unless (eq @hasShadow false) "euiImage--hasShadow")
      float=@float
      margin=@margin
      componentName="EuiImage"
      size=@size
    }}
    ...attributes
  >

    <button
      class="euiImage__button"
      type="button"
      aria-label={{@ariaLabel}}
      data-test-subj={{@dataTestSubj}}
      {{on "click" this.toggleFullscreen}}
    >
      <img
        src={{or @src @url}}
        class="euiImage__img"
        style={{this.sizeStyle}}
        alt={{@alt}}
      />
      <EuiIcon
        @iconClasses="euiImage__icon"
        @type="fullScreen"
        @color={{if (not-eq @fullScreenIconColor "dark") "ghost"}}
      />
    </button>

    {{#if @caption}}
      <figcaption class="euiImage__caption">
        {{@caption}}
      </figcaption>
    {{/if}}
  </figure>

{{else}}

  <figure
    class={{class-names
      (unless (eq @hasShadow false) "euiImage--hasShadow")
      float=@float
      margin=@margin
      componentName="EuiImage"
      size=@size
    }}
    ...attributes
  >

    <img
      src={{or @src @url}}
      class="euiImage__img"
      style={{this.sizeStyle}}
      alt={{@alt}}
    />

    {{#if @caption}}
      <figcaption class="euiImage__caption">
        {{@caption}}
      </figcaption>
    {{/if}}
  </figure>

{{/if}}

{{#if this.isFullscreen}}
  <EuiOverlayMask
    @headerZindexLocation="above"
    @onClick={{this.toggleFullscreen}}
  >
    <figure
      class="euiImage euiImage-isFullScreen"
      {{focus-trap focusTrapOptions=(hash clickOutsideDeactivates=true)}}
    >
      <button
        class="euiImage__button"
        type="button"
        {{on "click" this.toggleFullscreen}}
        {{on-key
          "Escape"
          (prevent-default (stop-propagation this.toggleFullscreen))
        }}
      >
        <img
          class="euiImage-isFullScreen__img"
          src={{or @src @url}}
          alt={{@alt}}
        />
      </button>
      <figcaption class="euiImage__caption">
        {{@caption}}
      </figcaption>
    </figure>
    <EuiIcon
      @iconClasses="euiImage-isFullScreenCloseIcon"
      @type="cross"
      @color={{if (not-eq @fullScreenIconColor "dark") "ghost"}}
    />
  </EuiOverlayMask>
{{/if}}